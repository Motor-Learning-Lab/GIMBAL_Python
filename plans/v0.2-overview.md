# GIMBAL-HMM v0.2 Roadmap (Phases 0.2.1–0.2.8)

This document defines the eight phases of GIMBAL-HMM **version 0.2**, following the successful completion of the v0.1 3-stage architecture.

**Assumption:**  
Priors in Phases 0.2.1–0.2.2 are derived from **whatever dataset we are currently working with** (synthetic now, later a selected real dataset).  
These machinery steps will work later when applied to large public datasets.

---

## Phase 0.2.1 — Coarse Anatomical Priors & Basic Cleaning

**Goal:**  
Stabilize the model before sampler testing by providing simple, physically sensible priors based on the current dataset and skeleton structure.

**Scope:**
- Derive coarse per-joint direction priors from current dataset or skeleton conventions  
  (e.g., torso/head near vertical, legs downward, arms broad but not pathological).
- Add basic keypoint sanity filters (impossible distances, gross outliers).
- Integrate these priors into Stage 3 as weak regularizing constraints.

**Outputs:**
- Coarse anatomical priors for `mu` and optionally `kappa`.
- Slightly more stable Stage-3 behavior even with the synthetic dataset.

---

## Phase 0.2.2 — k-Means / Clustering Empirical-Bayes Priors

**Goal:**  
Use clustering on the **current dataset** to create “gross” priors for emissions and transitions before sampler evaluation.

**Scope:**
- Run k-means (or similar) on joint directions or pose vectors from the current dataset.
- Estimate:
  - candidate per-state canonical directions (`mu_prior[s,k,:]`),
  - rough κ scales (spread within clusters),
  - empirical transition frequencies from cluster assignments.
- Convert these into:
  - direction priors per state,
  - κ priors per state (or per joint group),
  - Dirichlet transition priors for Stage 3.

**Outputs:**
- A simple empirical-Bayes prior generator for emissions and transitions based on clustering.

---

## Phase 0.2.3 — Sampler Decision Spike (With Priors in Place)

**Goal:**  
Decide whether to keep nutpie or switch to an alternative sampler.

**Scope:**
- Compare nutpie vs one candidate alternative (e.g., JAX HMC) on:
  - Stage-3 synthetic model with priors from 0.2.1–0.2.2,
  - possibly a short real sequence (if trivial).
- Evaluate:
  - convergence (R-hat, ESS),
  - runtime per effective sample,
  - robustness to moderate increases in S or T.

**Outputs:**
- Your v0.2 sampler choice, with basic tuning guidelines.

---

## Phase 0.2.4 — Minimal Synthetic Diagnostics (Visual + Numeric)

**Goal:**  
Implement a minimal diagnostic layer for quick detection of “broken” vs “healthy” synthetic runs.

**Scope:**
- Numeric diagnostics:
  - R-hat, ESS, divergences.
- Visual diagnostics:
  - state occupancy over time,
  - transition matrix heatmap,
  - canonical-direction plots (per-state joint arrows or unit-sphere view).
- Provide a simple diagnostic function callable from notebooks.

**Outputs:**
- A small diagnostics module integrated into the synthetic Stage-3 demo.

---

## Phase 0.2.5 — First Public Dataset Loader + Baseline Real-Data Fit

**Goal:**  
Run Stage 2+3 end-to-end on one real-data sequence.

**Scope:**
- Implement a loader and skeleton mapping for one public dataset (e.g., Human3.6M).
- Produce `y_obs (C,T,K,2)` and `x_gt (T,K,3)` in GIMBAL format.
- Run Stage 2+3 with:
  - sampler chosen in 0.2.3,
  - coarse priors from 0.2.1–0.2.2,
  - minimal diagnostics from 0.2.4.

**Outputs:**
- A baseline real-data notebook that successfully fits a short sequence.

---

## Phase 0.2.6 — Real-Data Diagnostics & Data-Driven Anatomical Priors

**Goal:**  
Extend diagnostics and replace coarse priors with true dataset-driven anatomical priors.

**Scope:**
- Add real-data metrics:
  - MPJPE, bone-length error,
  - velocity and optionally acceleration error.
- Add real-data visual diagnostics:
  - GT vs reconstruction overlays,
  - per-frame error-over-time plots,
  - side-by-side state/pose timelines.
- Compute empirical per-joint direction distributions from the dataset.
- Replace or refine coarse anatomical priors with these data-driven ones.

**Outputs:**
- A real-data diagnostic suite.
- Refined anatomical priors for Stage 3 based on real pose statistics.

---

## Phase 0.2.7 — Coarse PCA + Low-D HMM + Transition Upsampling

**Goal:**  
Learn coarse-scale dynamics in low-dimensional PCA space, then map them to full rate.

**Scope:**
- Downsample real data (e.g., 60→6 Hz); interpolate to avoid NaNs.
- PCA on full-pose space (~80% variance) → low-D embedding.
- Fit low-D HMM for several candidate S values.
- For each S:
  - estimate coarse-rate transition matrix `A_low`,
  - compute `A_high` by matrix-root / continuous-time conversion,
  - optionally compute coarse state sequences.

**Outputs:**
- PCA+low-D HMM module.
- Full-rate transition prior matrices `A_high` for candidate S.

---

## Phase 0.2.8 — PCA-Informed Priors for Full Model & State-Number Selection

**Goal:**  
Use PCA+HMM results to set state-specific priors and choose S.

**Scope:**
- For each candidate S:
  - map low-D state means → full-pose canonical joint directions,
  - derive κ priors from PCA-level variability,
  - use `A_high` as Dirichlet prior means for transitions.
- Refit full Stage 3 on real data.
- Compare across S using:
  - real-data geometry/temporal metrics,
  - HMM diagnostics,
  - model comparison measures.

**Outputs:**
- A stable real-data fit using PCA-informed priors.
- A recommended state count S (or narrow range of S).

---

# Deferred Ideas (Not in v0.2)

These were discussed but intentionally moved to a later version:

1. **Multi-dataset benchmarking** across multiple public datasets.  
2. **Grouped / hierarchical κ** beyond simple empirical estimates.  
3. **Variational Bayes experiments** for warm starts or rapid screening.  
4. **DP-HMM / nonparametric state-number models.**  
5. **Full codebase cleanup** (notebook triage, de-AI refactoring).  
6. **Supported workflows documentation** and tutorial notebooks.  
7. **Outlier / mixture observation models** beyond current mixture-Gaussian options.  
8. **Multi-modal extensions** (IMU + cameras).  
9. **Behavior segmentation tools** built on HMM states.  
10. **Motion-primitive library** extraction from learned states.

