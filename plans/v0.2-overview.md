# GIMBAL-HMM v0.2 Overview — Revised for Post-v0.2.0 State

Version 0.2 builds on the stable **three-stage PyMC HMM pipeline** delivered in v0.1:

1. **Stage 1 — Collapsed HMM engine** (`collapsed_hmm_loglik`)
2. **Stage 2 — Camera + kinematics** (`build_camera_observation_model`)
3. **Stage 3 — Directional HMM prior** (`add_directional_hmm_prior`)

Version **0.2.0 (now complete)** modernized and cleaned the repository, making the PyMC pipeline the canonical path and isolating legacy Torch components. The codebase is now ready for algorithmic improvements.

Version **0.2** advances the system toward:
- **robustness and stability**
- **real-data integration**
- **diagnostics**
- **data-derived priors**
- **principled state-number selection**

All priors in phases 0.2.1–0.2.2 are derived from the **current dataset** (synthetic for now; AIST++ later). The same machinery generalizes to public datasets in v0.3+.

---

# Version 0.2 consists of eight phases

## Phase 0.2.1 — Coarse Anatomical Priors & Basic Data Cleaning

**Purpose:** Stabilize early sampling and clustering by incorporating physically correct joint-direction priors and lightweight pose validation.

**Scope:**
- Weak anatomical direction priors
- Basic pose/keypoint cleaning
- Integration into Stage 3 via `prior_config`

**Outputs:** Early-stage stability for synthetic fits.

---

## Phase 0.2.2 — k-Means / Clustering Empirical-Bayes Priors

**Purpose:** Produce “gross” EB priors for canonical directions, κ, and transitions.

**Scope:**
- Clustering in joint-direction space
- Priors on `mu`, `kappa`, and transitions
- Derived from the current dataset only

**Outputs:** EB priors to support sampler evaluation.

---

## Phase 0.2.3 — Sampler Decision Spike (Nutpie vs Alternatives)

**Purpose:** Select the sampler for all subsequent v0.2 phases.

**Scope:**
- Compare nutpie, JAX-based HMC, and PyMC-NUTS
- Evaluate robustness, ESS, runtime
- Use priors from 0.2.1–0.2.2

**Outputs:** Definitive sampler choice.

---

## Phase 0.2.4 — Minimal Synthetic Diagnostics (Numeric + Visual)

**Purpose:** Build the first “fit health” diagnostic module.

**Scope:**
- Numeric: R-hat, ESS, divergences
- Visual: state trajectories, transition matrices, canonical directions

**Outputs:** `diagnostics_synthetic(model, idata)`.

---

## Phase 0.2.5 — AIST++ Loader & First Real-Data Pipeline Pass

**Purpose:** Achieve the first full Stage-2+3 run on real keypoint data.

**Scope:**
- Add AIST++ loader
- Map joints to GIMBAL skeleton
- Run Stage-2+3 with sampler from 0.2.3
- Evaluate with synthetic diagnostics

**Outputs:** First real-data end-to-end model run.

---

## Phase 0.2.6 — Real-Data Diagnostics & Data-Driven Anatomical Priors

**Purpose:** Enable validated, interpretable real-data fits.

**Scope:**
- Real-data metrics: MPJPE, bone-length error, smoothness
- Visual diagnostics: 3D trajectories, error-over-time
- Improve anatomical priors using AIST++ joint distributions

**Outputs:** Real-data diagnostic suite and refined anatomical priors.

---

## Phase 0.2.7 — PCA + Low-D HMM + Transition Upsampling

**Purpose:** Learn coarse motion dynamics in low-dimensional pose space.

**Scope:**
- Downsample to ~6 Hz
- PCA to ~80% variance
- Fit low-D HMM for several S
- Upsample transitions via `logm`/`expm`

**Outputs:** Low-D HMM components and full-rate transition priors.

---

## Phase 0.2.8 — PCA-Informed Priors & State-Number Selection

**Purpose:** Use PCA-HMM results to refine priors and select the number of states.

**Scope:**
- Map PCA states → full priors
- Full-model fits for multiple S
- Compare S using MPJPE, dwell-time stability, anatomy plausibility, diagnostics

**Outputs:** PCA-informed priors and principled choice of S.

---

# Deferred Topics (v0.3+)

- Multi-dataset validation
- Hierarchical κ models
- Variational warm-starts
- DP-HMM
- Workflow documentation
- Outlier emission models
- IMU fusion
- Behavior segmentation

---

# Summary

v0.2 moves the pipeline from a synthetic, validated design (v0.1) to a **robust, real-data-capable system** by:

1. Early anatomical + EB priors  
2. Sampler decision  
3. Diagnostics  
4. AIST++ integration  
5. Real-data anatomical priors  
6. PCA + low-D dynamics  
7. PCA-informed full priors  
8. Principled state-number selection

By the end of v0.2, GIMBAL-HMM becomes a **diagnosable, stable, real-data-ready** HMM-based 3D motion model.
