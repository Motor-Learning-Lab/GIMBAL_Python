# v0.2.1 Step‑1 Plan: Alignment, Pipeline, and Camera Priors

**Status:** Draft for Copilot implementation
**Scope:** This document defines the remaining work required to complete v0.2.1, focusing on:

1. Repository cleanup and naming/organization suggestions.
2. Alignment between specifications and the current codebase.
3. Design and implementation of an end‑to‑end testing pipeline for data‑driven skeleton priors on synthetic data.
4. A preliminary (placeholder) design for camera parameter priors.

v0.2.1 should be considered complete once:

* Spec and code are reasonably aligned (or divergences are consciously documented).
* There is at least one end‑to‑end test using data‑driven skeleton priors on synthetic data, with divergence/accuracy reported.
* A placeholder design for camera priors exists and is reflected in code structure (even if not fully implemented), with a clear note that end‑to‑end tests must be re‑run after camera priors are added.

---

## 1. Cleanup and Repository Organization (v0.2.1) — **Action‑Oriented Plan**

This section is rewritten to be **directive, structured, and operational** so that Copilot can execute it with minimal ambiguity. Every item below defines (1) the goal, (2) what Copilot must check, and (3) what artifact(s) Copilot must produce. All renames/moves remain suggestions until confirmed by a human.

---

### **1.1. Objectives of Cleanup (What v0.2.1 Requires Before Tagging)**

By the end of v0.2.1 cleanup:

1. The repository must have **one clear, canonical directory structure** with each top‑level directory serving a single purpose.
2. All diagnostics for v0.2.1 must be **grouped, named, and documented** so later versions can refer to them.
3. All planning/spec/naming documents must be **organized and pruned** so that future agents can find the authoritative spec quickly.
4. All remaining ambiguities must be captured in a machine‑readable suggestions file for human review.

Copilot’s job is to **identify**, **propose**, and **document** these changes—not perform destructive moves automatically.

---

### **1.2. Canonical Directory Structure (Forward‑Looking Contract)**

Copilot must verify that the repo conforms to the following canonical structure:

```
/ gimbal/          # Library code only (no notebooks, no diagnostic scripts)
/ tests/           # Unit + integration tests, including diagnostics
/ plans/           # Specs, plans, architecture docs, completion reports
/ notebook/        # Demo and exploratory notebooks, HTML exports, .py exports
/ examples/        # Minimal runnable scripts (optional)
/ results/         # Heavy artifacts generated by tests/diagnostics (JSON, logs)
```

If the repository deviates from this layout, Copilot must:

* List all deviations.
* Suggest where each file should logically move.
* Flag any ambiguous cases for human review.

**Deliverable:** Add a section to `v0.2.1_cleanup_suggestions.md` titled **“Canonical Layout Deviations”** containing a table:

```
| Path | Issue | Suggested Location | Notes |
```

---

### **1.3. Diagnostics Directory Normalization (Highest Priority)**

The single largest organizational issue is the divergence diagnostics for v0.2.1. Copilot must:

#### **Step 1 — Identify All v0.2.1 Diagnostics Artifacts**

Search for any file or directory containing:

* `v0_2_1_divergence`
* `tg09`, `tg10`, `tg11`, `I1`, `I2`, `I3`
* `divergence`

Build an inventory grouped by function:

```
Python test drivers
JSON results
Markdown reports
Plots and images
Logs / text outputs
```

#### **Step 2 — Enforce One of Two Organizational Schemes**

Copilot must evaluate the repository and **recommend either Scheme A or Scheme B**:

**Scheme A — All diagnostics live under `tests/diagnostics/v0_2_1_divergence/`**

* Tests, JSON, reports, and plots all in one place.
* `results/` used only for heavy artifacts that shouldn’t clutter tests.
* Naming standard:

  * `test_tgXX_*.py`
  * `results_tgXX_*.json`
  * `report_tgXX_*.md`
  * `plots/tgXX_*/...`

**Scheme B — Split “tests” vs “results” cleanly**

* `tests/diagnostics/v0_2_1_divergence/` → Python and Markdown
* `results/diagnostics/v0_2_1_divergence/` → JSON, logs, images
* Same naming standard as above.

Copilot must:

1. Recommend A or B with justification.
2. Produce a table listing every file and where it should move under the chosen scheme.
3. Identify any files that should instead be archived.

**Deliverable:** Section titled **“Diagnostics Normalization Plan (Recommended Scheme)”** in the cleanup suggestions file.

---

### **1.4. Plans Directory Normalization**

Currently `plans/` contains:

* Several overlapping v0.2.1 specs
* Naming policies
* Divergence plans
* Intermediate drafts

Copilot must:

#### **Step 1 — Identify authoritative vs. archival documents**

Authoritative docs for v0.2.1 should be:

1. One overview or architecture file
2. One spec for data‑driven priors
3. One naming convention file (already at repo root)
4. This alignment/pipeline plan

Anything else should be proposed for:

* **Archival** (`plans/archive/v0.2.1/`), or
* **Deletion** (only with explicit human instruction)

#### **Step 2 — Propose a canonical naming scheme**

Future files for v0.2.1 should use:

```
v0.2.1_<topic>_spec.md
v0.2.1_<topic>_plan.md
v0.2.1_<topic>_completion_report.md
```

Copilot must:

* Identify files violating this pattern.
* Suggest a corrected name.
* Flag ambiguous cases.

**Deliverable:** Section titled **“Plans Normalization Table”** in cleanup suggestions, with:

```
| File | Issue | Suggested Action | New Name (if any) |
```

---

### **1.5. Naming Convention Enforcement Rules (Concrete and Testable)**

Using `IMPORTANT_FILE_NAMING_CONVENTIONS.md`, Copilot must:

1. Parse the rules under:

   * *Diagnostic file naming conventions*
   * *Category and group naming patterns*
   * *Plans and specs naming*
2. Compare these rules against actual files.
3. Generate a list of **specific violations** and **specific fixes**.

Examples of violations Copilot must catch:

* Files with mixed delimiters: `v0-2_1`, `v0.2_1`, etc.
* Diagnostics without clear TG numbers.
* Result files not starting with `results_`.
* Reports not starting with `report_`.
* Plots not grouped under `plots/tgXX_*`.

**Deliverable:** Section titled **“Naming Violations and Fixes”** in the cleanup suggestions file.

---

### **1.6. Apply rules to this file**

If you haven't already, then make sure that all rules and organizational structure discussed above are applied to the name and placement of this file.

You can also add annotations to this file to show decisions made or changes in plans. Do not delete contents but rather add your own annotations in appropriate places.


---


### **1.7. Final Output of Cleanup Phase**

Copilot must produce one markdown file:

```
plans/v0.2.1_cleanup_suggestions.md
```

containing:

1. Canonical layout deviations (table)
2. Diagnostics normalization plan (chosen scheme + mapping)
3. Plans normalization table
4. Naming violations and proposed fixes
5. Ambiguities requiring human decision

Only after this file is created should the cleanup phase be considered complete.

